IDENTIFICATION DIVISION.
PROCEDURE DIVISION.
DECLARATIVES.
DET SECTION.
USE BEFORE REPORTING DETAIL-LINE.
DETA-1.
    ACCEPT ITEMF FROM DAY-OF-WEEK.
END DECLARATIVES.
begin.
    ACCEPT DEST-EXAMPLE FROM LINE NUMBER ITEMB PLUS 0
        ON EXCEPTION 
            ADD 2 ITEMB TO ITEMA.
        NOT ON EXCEPTION 
            ADD 38 TO ITEMA ITEMB.
    ADD 14 TO ITEMA
        NOT ON SIZE ERROR
            ACCEPT ITEMF FROM DAY-OF-WEEK.
        ON SIZE ERROR
            ACCEPT ITEMF FROM DAY-OF-WEEK.
    ADD 7 ITEMB TO ITEMD (ITEMB)
        ON SIZE ERROR
            ACCEPT ITEMF FROM DAY-OF-WEEK
    END-ADD
    ADD 1 TO ITEMB.
    ALTER PROC-A TO PROC-EE PROC-E TO PROC-CC.
    CALL "NEWPROG" USING ITEMA
        BY DESCRIPTOR ITEMB ITEMC "TOTALS"
        BY REFERENCE ITEMD "PAYROLL"
        BY VALUE ITEME 995.99
        BY DESCRIPTOR ITEMD ITEMF
        BY CONTENT ITEMG "SUMMARY FLAG".
    CALL PROG-TO-CALL USING ITEMA.
    CALL "PROG010" USING ITEMA ITEMB "XYZ"
        GIVING ITEMC
        ON EXCEPTION 
            CANCEL SUB-PROG-A "PROG12" SUB-PROG-B.
    CLOSE EMPLOYEE-FILE.
    CLOSE EMPLOYEE-FILE REEL NO REWIND.
    CLOSE EMPLOYEE-FILE LOCK.
    COMPUTE ITEMC =
        (ITEMA + 6) ** (.1 * ITEMD).
    COMPUTE ITEMC ROUNDED =
        (ITEMA + 6) ** (.1 * ITEMD)
        ON SIZE ERROR
            CANCEL SUB-PROG-A.
        NOT ON SIZE ERROR
            delete file-1.
    DISPLAY ITEMC.
    DISPLAY ITEMD UPON ERR-REPORTER.
    DISPLAY ITEMD ITEMA "ARE" ITEMB.
    DISPLAY ITEMD SPACE ITEMA "AREs" ITEMB.
    DISPLAY ITEMC "sISs" NO ADVANCING.
    DISPLAY
        ITEMF WITH CONVERSION LINE PLUS
        ITEMG WITH CONVERSION LINE PLUS
        ITEMH WITH CONVERSION LINE PLUS
        ITEMI WITH CONVERSION LINE PLUS.
    DIVIDE ITEMA INTO ITEMB.
    DIVIDE ITEMA INTO ITEMB ROUNDED.
    DIVIDE ITEMA INTO ITEMB
        GIVING ITEMD.
    DIVIDE ITEMA INTO ITEMB
        GIVING ITEMD ROUNDED.
    DIVIDE ITEMA BY ITEMB
        GIVING ITEMD.
    DIVIDE ITEMA INTO ITEMB
        GIVING ITEMD REMAINDER ITEMC.
    DIVIDE ITEMA INTO ITEMB 
        GIVING ITEMD ROUNDED REMAINDER ITEMC.
    DIVIDE ITEMA INTO ITEMB
        GIVING ITEME REMAINDER ITEMC.
    DIVIDE ITEMA INTO ITEMB
        GIVING ITEME ROUNDED REMAINDER ITEMC.
    DIVIDE ITEME INTO ITEMF GIVING ITEMG ITEMD
        ON SIZE ERROR
            DISPLAY ITEMC.
    EVALUATE ITEMA
        WHEN A-01 ALPHABETIC ACCEPT ITEMA FROM DAY-OF-WEEK
        WHEN "A02" THRU "C16" ACCEPT ITEMB FROM DAY-OF-WEEK
        WHEN "C20" THRU "L86" ACCEPT ITEMC FROM DAY-OF-WEEK
        WHEN "R20" ADD 1 TO R-TOT
                   ACCEPT ITEMD FROM DAY-OF-WEEK
        WHEN OTHER ACCEPT ITEME FROM DAY-OF-WEEK
    END-EVALUATE.
    EVALUATE LOW-STOK   WEEK-USE        LOC-VNDR    ON-ORDER    TRUE
        WHEN "Y",       16 THRU 999,    ANY,        "N"         A > 10          GO TO RUSH-ORDER
        WHEN "Y",       16 THRU 999,    ANY,        "Y"         A > 20          GO TO NORMAL-ORDER
        WHEN "Y",       8 THRU 15,      "N",        "N"         A > 30          GO TO RUSH-ORDER
        WHEN "Y",       8 THRU 15,      "N",        "Y"         A < 10          GO TO NORMAL-ORDER
        WHEN "Y",       8 THRU 15,      "Y",        "N"         A < 20          GO TO NORMAL-ORDER
        WHEN "Y",       0 THRU 7,       ANY,        "N"         A = ZERO        GO TO NORMAL-ORDER
        WHEN "N",       ANY,            ANY,        "Y"         NOT A = ZERO    GO TO CANCEL-ORDER
    END-EVALUATE.
REPORT-INVALID-ADD.
    DISPLAY " ".
    DISPLAY "INVALID ADDITION".
    DISPLAY "RECORD ALREADY EXISTS".
    DISPLAY "UPDATE ATTEMPT: " UPDATE-REC.
    DISPLAY "EXISTING RECORD: " OLD-REC.
REPORT-INVALID-ADD-EXIT.
    EXIT.
cont-para.
    IF ITEMA < 20
        MOVE "X" TO ITEMB.
* comment
    IF ITEMA > 10
        MOVE "X" TO ITEMB
    ELSE
        GO TO PROC-A.

    IF ITEMA < 10 OR > 20
        NEXT SENTENCE
    ELSE
        MOVE "X" TO ITEMB.
* comment
    IF ITEMA > 10
        IF ITEMA = ITEMC
            MOVE "X" TO ITEMB
        ELSE
            MOVE "Y" TO ITEMB
    ELSE
        GO TO PROC-A.
    IF ITEMA > 10
        IF ITEMA = ITEMC
            ADD 1 TO ITEMD
            MOVE "X" TO ITEMB
        END-IF
        ADD 1 TO ITEMD.
    INITIALIZE ITEMA.
    INITIALIZE ITEMB ITEMG.
    INITIALIZE ITEMA REPLACING ALPHANUMERIC BY "ABCDE".
    INITIALIZE ITEMG REPLACING NUMERIC BY 9.
    INITIALIZE ITEMA REPLACING NUMERIC-EDITED BY 16.
    INITIALIZE ITEMA REPLACING ALPHANUMERIC-EDITED BY "ABCD".
    INITIALIZE ITEMA REPLACING ALPHANUMERIC BY "99".
    INITIALIZE ITEMB ITEMG 
        REPLACING 
            ALPHANUMERIC BY "ABCDE"
            NUMERIC BY 9.
    INSPECT ITEMA TALLYING COUNT1 FOR LEADING "L" BEFORE "A",
        COUNT2 FOR LEADING "A" BEFORE "L".
    INSPECT ITEMA TALLYING COUNT1 FOR ALL "L" "R"
        REPLACING LEADING "A" BY "E" AFTER INITIAL "L".
    INSPECT ITEMA REPLACING ALL "A" BY "G" BEFORE "X".
    INSPECT ITEMA TALLYING COUNT1 FOR CHARACTERS AFTER "J"
        REPLACING ALL "A" BY "B".
    INSPECT ITEMA REPLACING ALL "X" BY "Y", "B" BY "Z",
        "W" BY "Q" AFTER "R".
    INSPECT ITEMA REPLACING CHARACTERS BY "B" BEFORE "A".
    INSPECT ITEMA REPLACING ALL "A" BY "X" ALL "R" BY "X"
        AFTER "XXL".
    INSPECT ITEMA CONVERTING "SIR" TO "DTA"
        AFTER QUOTE BEFORE "@".
    if a < 100 then
        merge file-1 ascending key-1 key-2 descending key-3
            sequence alph-1
            using file-2 file-3 file-4
            output procedure is out-proc-1 thru end-proc-1
    else 
        exit
    end-if
    MULTIPLY 2 BY ITEMB.
    MULTIPLY 3 BY 1-A of 2-a in 3-b-group giving ITEMB
        ON SIZE ERROR
            MOVE 0 TO ITEMC.
    MULTIPLY 4 BY ITEMA ITEMB ITEMC
        ON SIZE ERROR
            MOVE 1 TO ITEMD
    END-MULTIPLY
    MULTIPLY 2 BY ITEMA ITEMB ITEMC
        ON SIZE ERROR
            ADD 1 TO ITEMD
    END-MULTIPLY.
    OPEN INPUT MASTER-FILE NO REWIND ALLOWING UPDATERS READERS
         I-O employee-file LOCK.
    OPEN INPUT FILE1-SEQ file2-seq file-3seq allowing no 
         extend ext-file-1.
    OPEN OUTPUT FILE1-RAN no-rewind.
    OPEN I-O FILE1-DYN.
    OPEN EXTEND FILE1-EXT.
    PERFORM PROC-A THRU PROC-B
        TEST BEFORE
        VARYING ITEMA
        FROM ITEMB BY ITEMC
        UNTIL CONDITION-A.
    PERFORM PROC-A THRU PROC-B
        TEST BEFORE
        VARYING ITEMA
            FROM ITEMB BY ITEMC
            UNTIL CONDITION-A
        AFTER ITEMD
            FROM ITEME BY ITEMF
            UNTIL CONDITION-B.
    PERFORM PROC-A THRU PROC-B
        TEST AFTER
        VARYING ITEMA
            FROM ITEMB BY ITEMC
            UNTIL CONDITION-A.
    PERFORM PROC-A THRU PROC-C 3 TIMES.
    PERFORM PROC-A THRU PROC-B
        VARYING ITEMC FROM 1 BY 1
        UNTIL ITEMC > 5.
    PERFORM PROC-A THRU PROC-B TEST AFTER VARYING ITEMC FROM 1 BY 1 UNTIL ITEMC > 5.
    PERFORM
        VARYING ITEMC FROM 1 BY 2
        UNTIL ITEMC > 7
            MOVE CHARA (ITEMC) TO CHARB (ITEMC)
            MOVE CHARA (ITEMC) TO CHARB (ITEMC + 3)
    END-PERFORM.
    READ MASTER-FILE KEY IS MASTER-KEY ALLOWING NO OTHERS.
    READ employee-file NEXT RECORD WITH LOCK
        AT END GO TO 999-EOJ..
    READ employee-file NEXT WITH LOCK.
    READ FILE-A INTO rec-a
        REGARDLESS OF LOCK
        AT END PERFORM NO-MORE-RECS
               DISPLAY "No more records." END-READ.
    IF ITEMA = ITEMB
        READ FILEA ALLOWING UPDATERS
            AT END MOVE ITEMC TO ITEMB
                   MOVE ITEMC-1 TO ITEMB-1
    ELSE
        MOVE ITEMD TO ITEME.
    READ FILE-A INVALID KEY CONTINUE.
    RECORD DEPENDENCY path-name TYPE IS relation-type IN DICTIONARY.
    RELEASE rec FROM src-area.
    RETURN smrg-file RECORD INTO dest-area 
        AT END CONTINUE
        NOT AT END 
            DISPLAY "No more records."
            exit
    END-RETURN
    REWRITE rec-name FROM src-item
        ALLOWING NO OTHERS
        INVALID KEY CONTINUE
        NOT INVALID KEY EXIT
    END-REWRITE
    SEARCH ALL STATES
        AT END
            MOVE 1 TO STATE-ERROR
            GO TO SEARCH-END
        WHEN STATE-USPS-CODE (STATE-INDEX) = CUSTOMER-USPS-STATE
            MOVE 0 TO STATE-ERROR
            MOVE STATE-REGION (STATE-INDEX) TO CUSTOMER-REGION.
* search
INITIALIZE-SEARCH.
    MOVE "2" TO CUSTOMER-REGION.
SEARCH-LOOP.
    SEARCH STATES
        AT END
            MOVE 1 TO STATE-ERROR
            GO TO SEARCH-END
        WHEN STATE-REGION (STATE-INDEX) = CUSTOMER-REGION
            MOVE 0 TO STATE-ERROR
            DISPLAY STATE-USPS-CODE (STATE-INDEX)
                " " STATE-INDEX WITH CONVERSION
                " " STATE-ERROR
        WHEN STATE-USPS-CODE (STATE-INDEX) = CUSTOMER-USPS-STATE
            MOVE STATE-NUM TO STATE-INDEX.
    ADD 1 TO STATE-INDEX.
    GO TO SEARCH-LOOP.
SEARCH-END.
    SEARCH NAME-ENTRY
        AT END
            DISPLAY " Table full"
            MOVE 1 TO NAME-INDEX
            PERFORM SHOW-TABLE 8 TIMES
            EXIT
        WHEN LAST-NAME (NAME-INDEX) = CUSTOMER-NAME
            ADD 1 TO NAME-COUNT (NAME-INDEX)
        WHEN LAST-NAME (NAME-INDEX) = SPACES
            MOVE CUSTOMER-NAME TO LAST-NAME (NAME-INDEX)
            MOVE 1 TO NAME-COUNT (NAME-INDEX).
    SET COURSE-INDEX TO 5.
    SET COURSE-INDEX UP BY 1.
    SET COURSE-INDEX DOWN BY DECREMENT-VALUE.
    SET SOPHOMORE TO TRUE
    SET REPORT-RUN TO OFF.
    SET POINTER-VAR TO REFERENCE OF Z(I,J,K).
    SET RETURN-STATUS TO FAILURE.
    sort tabl descending elem-item2 elem-item3.
    sort tabl2 descending elem-item1 of group2
        sequence alph-2
        input procedure proc-1 through proc-2
        giving file-1 file-2 file-3.
    start file-name KEY GREATER THAN OR EQUAL key-data
        ALLOWING READERS
        INVALID
            MOVE CUSTOMER-NAME TO LAST-NAME (NAME-INDEX)
    END-START
    STOP RUN
    STOP "ass"
    STOP SPACE.
    STRING CIVIL-TITLE DELIMITED BY " "
        " " DELIMITED BY SIZE
        FIRST-NAME DELIMITED BY " "
        " " DELIMITED BY SIZE
        LAST-NAME DELIMITED BY SIZE
        INTO TEXT-STRING.
    STRING CITY DELIMITED BY "/"
        ", " DELIMITED BY SIZE
        STATE DELIMITED BY SIZE
        " " DELIMITED BY SIZE
        ZIP DELIMITED BY SIZE
        INTO TEXT-STRING.
* =================================
    MOVE 0 TO LINE-COUNT.
    MOVE 1 TO PTR.
GET-WORD.
    IF LINE-COUNT NOT < 4
        DISPLAY " " TEXT-STRING
        GO TO GOT-WORDS.
    ACCEPT INPUT-MESSAGE.
    DISPLAY INPUT-MESSAGE.
SAME-WORD.
    MOVE PTR TO HOLD-PTR.
    STRING INPUT-MESSAGE DELIMITED BY SPACE
        ", " DELIMITED BY SIZE
        INTO TEXT-STRING
            WITH POINTER PTR
        ON OVERFLOW
            STRING " " DELIMITED BY SIZE
                INTO TEXT-STRING
                    WITH POINTER HOLD-PTR
            DISPLAY " " TEXT-STRING
            MOVE SPACES TO TEXT-STRING
            ADD 1 TO LINE-COUNT
            MOVE 1 TO PTR
            GO TO SAME-WORD.
    GO TO GET-WORD.
GOT-WORDS.
    EXIT.
* ===================================
    SUBTRACT 2 ITEMB FROM ITEMA.
    SUBTRACT 14 FROM ITEMA, ITEME
        ON SIZE ERROR
            MOVE 0 TO ITEMB.
    SUBTRACT 14 FROM ITEMA
        ON SIZE ERROR
            MOVE 9 TO ITEMB.
        NOT ON SIZE ERROR
            MOVE 1 TO ITEMB.
    SUBTRACT 1 FROM ITEMB ITEMD (ITEMB).
    SUBTRACT ITEME ITEMD (ITEMB) FROM ITEMA
        GIVING ITEMB.
    SUBTRACT 10 ITEMB FROM ITEMD (ITEMB)
        ON SIZE ERROR
            MOVE 0 TO ITEMA
    END-SUBTRACT.
    IF ITEMB < 3 AND > 1
        SUBTRACT 1 FROM ITEMD(ITEMB)
            ON SIZE ERROR
            MOVE 0 TO ITEMA
        END-SUBTRACT
        DISPLAY 'yes'
    ELSE
        DISPLAY 'no'.
    SUBTRACT 1, A, B FROM ITEMA ROUNDED, ITEN-B.
*****
    SUPPRESS PRINTING
    SUPPRESS
    TERMINATE report-name1 report-name2
    UNLOCK file-name1 RECORDS
    UNLOCK file-name2 ALL
    UNLOCK file-name3
*****
    UNSTRING INMESSAGE
        DELIMITED BY "-" OR "/" OR ALL " "
            INTO THEMONTH DELIMITER IN HOLD-DELIM
                 THEDAY   DELIMITER IN HOLD-DELIM
                 THEYEAR  DELIMITER IN HOLD-DELIM
        ON OVERFLOW MOVE ALL "0" TO THEDATE.
    INSPECT THEDATE REPLACING ALL " " BY "0".
*
    WRITE RECORD-OUT
        FROM FUNCTION UPPER-CASE(NAME-FIELD).
    WRITE REPORT-REC AFTER STARTING-NEW-FORM.
    WRITE rec-name
        ALLOWING NO OTHERS
        BEFORE advance-num LINES
        END-OF-PAGE
            EXIT
        NOT EOP
            CONTINUE
            DISPLAY "Continue!"
    END-WRITE
END PROGRAM.
