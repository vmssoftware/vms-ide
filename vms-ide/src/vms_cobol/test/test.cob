  IDENTIFICATION DIVISION.
PROGRAM-ID. RMSSPECREGS.
*
* This program demonstrates the use of RMS special registers to
* implement a different recovery for each of several errors with RMS files.
*
AUTHOR. Me
* comment in author
    and all my friends!
	INPUT-OUTPUT SECTION.
 	INPUT-OUTPUT SECTION.
* comment in author
  	INPUT-OUTPUT SECTION.
   	INPUT-OUTPUT SECTION.
* comment in author
   ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
SELECT OPTIONAL EMP-FILE ASSIGN "SYS$DISK:ART.DAT".
SELECT REPORT-FILE ASSIGN "SYS$OUTPUT".
DATA DIVISION.
FILE SECTION.
FD EMP-FILE VALUE OF ID IS VAL-OF-ID.
01 EMP-RECORD.
    02 EMP-ID PIC 9(7).
    02 EMP-NAME PIC X(15).
    02 EMP-ADDRESS PIC X(30).
FD REPORT-FILE REPORT IS RPT.
WORKING-STORAGE SECTION.
01 VAL-OF-ID PIC X(20).
01 RMS$_EOF PIC S9(9) COMP VALUE EXTERNAL RMS$_EOF.
01 SS$_BADFILENAME PIC S9(9) COMP VALUE EXTERNAL SS$_BADFILENAME.
01 RMS$_FNF PIC S9(9) COMP VALUE EXTERNAL RMS$_FNF.
01 RMS$_DNF PIC S9(9) COMP VALUE EXTERNAL RMS$_DNF.
01 RMS$_DEV PIC S9(9) COMP VALUE EXTERNAL RMS$_DEV.
01 D-DATE PIC 9(6).
01 EOF-SW PIC X.
    88 E-O-F VALUE "E".
    88 NOT-E-O-F VALUE "N".
01 VAL-OP-SW PIC X.
    88 VALID-OP VALUE "V".
    88 OP-FAILED VALUE "F".
01 OP PIC X.
    88 OP-OPEN VALUE "O".
    88 OP-CLOSE VALUE "C".
    88 OP-READ VALUE "R".
REPORT SECTION.
RD RPT PAGE 26 LINES HEADING 1 FIRST DETAIL 5.
01 TYPE IS PAGE HEADING.
    02 LINE IS PLUS 1.
        03 COLUMN 1 PIC X(16) VALUE "Emplyee File on".
        03 COLUMN 18 PIC 99/99/99 SOURCE D-DATE.
    02 LINE IS PLUS 2.
        03 COLUMN 2 PIC X(5) VALUE "Empid".
        03 COLUMN 22 PIC X(4) VALUE "Name".
        03 COLUMN 43 PIC X(7) VALUE "Address".
        03 COLUMN 60 PIC X(4) VALUE "Page".
        03 COLUMN 70 PIC ZZ9 SOURCE PAGE-COUNTER.
01 REPORT-LINE TYPE IS DETAIL.
    02 LINE IS PLUS 1.
        03 COLUMN IS 1 PIC 9(7) SOURCE EMP-ID.
        03 COLUMN IS 20 PIC X(15) SOURCE IS EMP-NAME.
        03 COLUMN IS 42 PIC X(30) SOURCE IS EMP-ADDRESS.
PROCEDURE DIVISION.
